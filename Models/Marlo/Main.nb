Notebook[{

Cell[CellGroupData[{
Cell["Load Libraries and Create The Model", \
"Chapter",ExpressionUUID->"fc3b81da-7494-4270-a70f-0a6dda4a549b"],

Cell[CellGroupData[{

Cell["Load Libraries", \
"Section",ExpressionUUID->"0e461209-cacd-4dbd-9f79-a6e17f30b901"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"core", " ", "RBD"}], " ", "&"}], " ", "NCM", " ", "library"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<../../\>\""}],
        "}"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", " ", "\"\<SIMple`\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"dynamics", " ", "+", " ", 
      RowBox[{"NCM", " ", "helper", " ", "functions"}]}], ",", " ", 
     RowBox[{"see", " ", 
      RowBox[{"Marlo", ".", "nb"}], " ", "for", " ", "model", " ", 
      "information"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<../\>\""}], 
       "}"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", " ", "\"\<Marlo`\>\""}], ";"}]}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"bf6108dc-fbe2-44e3-aeae-0fb13e435ef2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compile Biped", \
"Section",ExpressionUUID->"e81aa74e-a510-4362-8abd-64d95aec56dc"],

Cell["\<\
Refer to CompassGait/Main.nb for detailed description of this code.\
\>", "Text",ExpressionUUID->"325f8cdd-1040-4a2d-89ce-902204c03b49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Marlo", "[", "n", "]"}], ";"}], " ", "//", " ", 
  "AbsoluteTiming"}]}], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"8f2565e8-6cfb-4ebc-ad04-bf14a0e57f0e"],

Cell[CellGroupData[{

Cell["Print a summary of biped variables", \
"Subsection",ExpressionUUID->"81cd3aa7-5905-4fb3-8040-db8a8a86ce8f"],

Cell["\<\
Refer to Atlas/Main.nb for detailed description of this code.\
\>", "Text",ExpressionUUID->"2d8327cd-31df-4c0b-a134-d45327f001a5"],

Cell[BoxData[
 RowBox[{"BLSummary", "[", "]"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"8017ba92-04b1-45ea-a867-da1da1e80d10"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load Gaits (optional)", \
"Section",ExpressionUUID->"4a1d1731-6389-4657-903e-cd3886cf951d"],

Cell["\<\
load pre-computed gaits; loading gaits will load the following variables \
(these are the same variable names used in the section \
\[OpenCurlyDoubleQuote]Generate Gaits\[CloseCurlyDoubleQuote]):

variable name\t\t|  description
------------------------------------------------------------------------------\
---------------------------
rootman\t\t\t|  branches of gaits ending in a gait walking on flat ground

NOTE: You can skip the next code block, Genera Gaits, if you load these gaits.\
\>", "Text",ExpressionUUID->"92f10037-fe42-4deb-85a7-f1a0f6c41e5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BLGetFrom", "[", 
   RowBox[{"\"\<Here\>\"", ",", " ", "\"\<marlo-ghm.mx\>\""}], "]"}], 
  ";"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"19743b21-579e-479e-bc0e-8c43f0725d0f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Gaits", \
"Chapter",ExpressionUUID->"9694b720-85e3-4eb4-a78e-e06f4f9957f1"],

Cell[CellGroupData[{

Cell["Generate Gaits using GHM", \
"Section",ExpressionUUID->"ef5a47a0-b034-4dbf-9144-aba3cf74c1b4"],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 InitializationCell->
  True,ExpressionUUID->"563b9f12-9bcd-41ef-b38c-fdf4dfd82af2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLSwingFoot", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<i\>\"", " ", "\[Rule]", " ", "Automatic"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLSwingFoot", "[", 
    RowBox[{"t_", ",", " ", "M_", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "m", ",", " ", "x", ",", " ", "c", ",", " ", "P", ",", " ", "i", ",", 
       " ", "w", ",", " ", "L"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", " ", "=", " ", 
       RowBox[{
        RowBox[{"M", "[", "\"\<m[t]\>\"", "]"}], "[", "t", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{
        RowBox[{"M", "[", "\"\<x[t]\>\"", "]"}], "[", "t", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{
        RowBox[{"M", "[", "\"\<c[t]\>\"", "]"}], "[", "t", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"w", " ", "=", " ", 
       RowBox[{"BLSide", "[", 
        RowBox[{"m", ",", " ", "Automatic", ",", " ", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"devec", "[", 
        RowBox[{"x", ",", " ", "nx"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"devec", "[", 
        RowBox[{"c", ",", " ", "nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"P", " ", "=", " ", 
       RowBox[{
        RowBox[{"BLbiped", "[", 
         RowBox[{"\"\<\[Eta]0\>\"", ",", " ", "w"}], "]"}], "[", 
        RowBox[{"x", ",", " ", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"work", " ", "in", " ", "scaled", " ", "coordinates"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"L", " ", "=", " ", 
       RowBox[{"BLbiped", "[", 
        RowBox[{"\"\<draw\>\"", ",", " ", "\"\<scale\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"get", " ", "indices", " ", "into", " ", "coefficients"}], 
        ",", " ", 
        RowBox[{"assuming", " ", "in", " ", "\[Alpha]0"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<i\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", " ", "===", " ", "Automatic"}], ",", " ", 
        RowBox[{"i", " ", "=", " ", 
         RowBox[{
          RowBox[{"BLbiped", "[", 
           RowBox[{"\"\<draw\>\"", ",", " ", "\"\<axes\>\""}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", 
            RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}]}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{
        RowBox[{"BLbiped", "[", 
         RowBox[{
         "\"\<\[Alpha]\>\"", ",", " ", "w", ",", " ", "\"\<\[Alpha]0\>\""}], 
         "]"}], "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"devec", "[", 
        RowBox[{"P", ",", " ", "nc"}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", " ", "i"}], "\[RightDoubleBracket]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"/", "L"}], "*)"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BLFootHeight", "[", 
    RowBox[{"t_", ",", " ", "M_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p", ",", " ", "X0", ",", " ", "XT", ",", " ", "C0", ",", " ", "CT", 
       ",", " ", "L0", ",", " ", "R0", ",", " ", "LT", ",", " ", "RT", ",", 
       " ", "HP", ",", " ", "a", ",", " ", "b"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X0", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{
         RowBox[{"M", "[", "\"\<x-\>\"", "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"XT", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{
         RowBox[{"M", "[", "\"\<x-\>\"", "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"C0", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{
         RowBox[{"M", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CT", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{
         RowBox[{"M", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", 
         RowBox[{"-", "0.5"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"L0", " ", "=", " ", 
       RowBox[{"RBDSpatialPosition", "[", 
        RowBox[{"p", ",", " ", "\"\<left_lower_leg\>\"", ",", " ", 
         RowBox[{"\"\<x\>\"", " ", "\[Rule]", " ", "X0"}], ",", " ", 
         RowBox[{"\"\<\[Lambda]\>\"", " ", "\[Rule]", " ", "C0"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"R0", " ", "=", " ", 
       RowBox[{"RBDSpatialPosition", "[", 
        RowBox[{"p", ",", " ", "\"\<right_lower_leg\>\"", ",", " ", 
         RowBox[{"\"\<x\>\"", " ", "\[Rule]", " ", "X0"}], ",", " ", 
         RowBox[{"\"\<\[Lambda]\>\"", " ", "\[Rule]", " ", "C0"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"LT", " ", "=", " ", 
       RowBox[{"RBDSpatialPosition", "[", 
        RowBox[{"p", ",", " ", "\"\<left_lower_leg\>\"", ",", " ", 
         RowBox[{"\"\<x\>\"", " ", "\[Rule]", " ", "XT"}], ",", " ", 
         RowBox[{"\"\<\[Lambda]\>\"", " ", "\[Rule]", " ", "CT"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"RT", " ", "=", " ", 
       RowBox[{"RBDSpatialPosition", "[", 
        RowBox[{"p", ",", " ", "\"\<right_lower_leg\>\"", ",", " ", 
         RowBox[{"\"\<x\>\"", " ", "\[Rule]", " ", "XT"}], ",", " ", 
         RowBox[{"\"\<\[Lambda]\>\"", " ", "\[Rule]", " ", "CT"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"PossibleZeroQ", "@", 
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"L0", "\[LeftDoubleBracket]", 
           RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], " ", "-", " ", 
          RowBox[{"R0", "\[LeftDoubleBracket]", 
           RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"HP", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{"p", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"L0", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "L0", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
              "+", "1"}], ",", " ", 
             RowBox[{
             "L0", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}], 
            "}"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"L0", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"R0", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HP", " ", "=", " ", 
       RowBox[{"HalfPlane", "[", 
        RowBox[{"HP", ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HP", " ", "=", " ", 
       RowBox[{"SignedRegionDistance", "[", "HP", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"a", ",", " ", "b"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HP", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"HP", "[", "p", "]"}], ",", " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"HP", "[", "p", "]"}], ",", " ", 
           RowBox[{"{", "p", "}"}]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"BLSwingFoot", "[", 
        RowBox[{"t", ",", " ", "M"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HP", " ", "=", " ", 
       RowBox[{"HP", " ", "/.", " ", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", " ", "b"}], "}"}], " ", "\[Rule]", " ", 
          RowBox[{
          "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"HP", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
        RowBox[{
         RowBox[{"HP", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;", "2"}], "\[RightDoubleBracket]"}], ".", 
         RowBox[{
         "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"knees", "[", 
     RowBox[{"M_", ",", " ", 
      RowBox[{"xa_:", "True"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t", ",", " ", "T", ",", " ", "x0", ",", " ", "a0", ",", " ", "f0", 
        ",", " ", "f", ",", " ", "x", ",", " ", "a", ",", " ", "eqn", ",", 
        " ", "evnt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", " ", "=", " ", 
        RowBox[{
         RowBox[{"M", "[", "\"\<T\>\"", "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"t_", "?", "NumberQ"}], "]"}], " ", ":=", " ", 
        RowBox[{"Flatten", "@", 
         RowBox[{"BLFootHeight", "[", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"t", ",", " ", "T"}], "]"}], ",", " ", "M"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"f0", " ", "=", " ", 
        RowBox[{"f", "[", "0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a0", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "f0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "\[LessEqual]", " ", "0"}], ",", " ", "1", ",", " ", "0"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"x0", " ", "=", " ", 
        RowBox[{"a0", " ", "f0"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"eqn", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "'"}], "[", "t", "]"}], " ", "\[Equal]", " ", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], " ", 
            RowBox[{"f", "[", "t", "]"}]}]}], ",", " ", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], " ", "\[Equal]", " ", "x0"}], ",", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], " ", "\[Equal]", " ", "a0"}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"evnt", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"WhenEvent", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"f", "[", "t", "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], " ", "\[Equal]", "  ", "0"}], ",", 
           " ", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], " ", "\[Rule]", " ", 
            RowBox[{"1", "-", 
             RowBox[{"a", "[", "t", "]"}]}]}]}], "]"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "a"}], "}"}], " ", "=", " ", 
        RowBox[{"NDSolveValue", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"eqn", ",", " ", "evnt"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"x", ",", " ", "a"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "0", ",", " ", "T"}], "}"}], ",", " ", 
          RowBox[{"DiscreteVariables", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"a", " ", "\[Element]", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"xa", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "a"}], "}"}], ",", " ", 
         RowBox[{"devec", "[", 
          RowBox[{
           RowBox[{"x", "[", "T", "]"}], ",", " ", "1"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"step", "[", "A_Association", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X0", ",", " ", "XT"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X0", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "\"\<x-\>\"", "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"XT", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "\"\<x-\>\"", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XT", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", 
         RowBox[{"3", ";;", "3"}]}], "\[RightDoubleBracket]"}], " ", "-", " ", 
       RowBox[{"X0", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", 
         RowBox[{"3", ";;", "3"}]}], "\[RightDoubleBracket]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"step", "[", 
    RowBox[{"c_", ",", " ", 
     RowBox[{"m_:", "Automatic"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mp", ",", " ", "M"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mp", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", " ", "===", " ", "Automatic"}], ",", " ", 
         RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "m"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"BLP", "[", 
        RowBox[{"mp", ",", " ", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"step", "[", "M", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vel", "[", "A_Association", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", " ", "D"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"-", "1"}], ",", " ", "All", ",", " ", 
         RowBox[{
          RowBox[{"-", "1"}], ";;", 
          RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"D", " ", "=", " ", 
       RowBox[{"step", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "/", 
         RowBox[{
         "T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
            RowBox[{
            "D", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "-", 
           RowBox[{
            RowBox[{"D", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", " ", "1"}], "\[RightDoubleBracket]"}], 
            RowBox[{
            "T", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
          ")"}], "/", 
         RowBox[{
          RowBox[{"T", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", " ", "1"}], "\[RightDoubleBracket]"}], "^", 
          "2"}]}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vel", "[", 
    RowBox[{"c_", ",", " ", 
     RowBox[{"m_:", "Automatic"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mp", ",", " ", "M"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mp", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", " ", "===", " ", "Automatic"}], ",", " ", 
         RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "m"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"BLP", "[", 
        RowBox[{"mp", ",", " ", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vel", "[", "M", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"slope", "[", "A_Association", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", " ", "X", ",", " ", "C", ",", " ", "S"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", 
        RowBox[{
         RowBox[{"A", "[", "\"\<m\>\"", "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"X", " ", "=", " ", 
        RowBox[{
         RowBox[{"A", "[", "\"\<x-\>\"", "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{
         RowBox[{"A", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BLbiped", "[", 
            RowBox[{"\"\<\[Sigma]\>\"", ",", " ", "m"}], "]"}], "[", 
           RowBox[{"X", ",", " ", "C"}], "]"}], ",", " ", "mm"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", "m"}], "\[RightDoubleBracket]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"slope", "[", 
    RowBox[{"c_", ",", " ", 
     RowBox[{"m_:", "Automatic"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mp", ",", " ", "M"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mp", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", " ", "===", " ", "Automatic"}], ",", " ", 
         RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "m"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"BLP", "[", 
        RowBox[{"mp", ",", " ", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"slope", "[", "M", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"c9249614-3934-4970-916f-ad403dfc69e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global Homotopy Maps", \
"Subsection",ExpressionUUID->"773adc44-7570-45b6-97b2-b746bab0a99d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MarloT", "[", 
     RowBox[{"cp_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"MarloT", "[", 
      RowBox[{
       RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "cp", ",", 
       " ", "opts"}], "]"}], "[", "\"\<R\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MarloT", "[", 
    RowBox[{"m_String", ",", " ", "cp_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", " ", "n", ",", " ", "M", ",", " ", "C", ",", " ", "X", ",", 
       " ", "S", ",", " ", "Q"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"BLP", "[", 
        RowBox[{"m", ",", " ", "cp", ",", " ", "opts"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"configuration", " ", "constraints"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Q", " ", "=", " ", 
       RowBox[{
        RowBox[{"M", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", " ", "All", ",", " ", 
         RowBox[{"{", 
          RowBox[{"5", ",", " ", "6", ",", " ", "8", ",", " ", "9"}], "}"}]}],
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"slack", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", "BipedalLocomotion`Marlo`Private`n\[Mu]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"S", " ", "=", " ", 
       RowBox[{
        RowBox[{"M", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", " ", "All", ",", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"n", "+", "1"}], ")"}]}], ";;", 
          RowBox[{"-", "3"}]}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"inequality", " ", "constraints"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"nq", "+", "3"}], "}"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"foward", " ", "y", " ", "velocity"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"X", " ", "=", " ", 
       RowBox[{
        RowBox[{"M", "[", "\"\<x-\>\"", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", " ", "All", ",", " ", "i"}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"10", ",", "13"}], "]"}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"correct", " ", "4"}], "-", 
        RowBox[{"bar", " ", "pose"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{
        RowBox[{"M", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", " ", "All", ",", " ", "i"}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"C", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "3"}], "}"}]}], "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{"C", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"2", ",", " ", "4"}], "}"}]}], 
           "\[RightDoubleBracket]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"C", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}], "-", 
          RowBox[{"C", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Join", ",", " ", 
         RowBox[{"{", 
          RowBox[{"C", ",", " ", "X"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"periodicity", " ", "constraints"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"BLbiped", "[", 
          RowBox[{"\"\<c\>\"", ",", " ", "m", ",", " ", "\"\<x\>\""}], 
          "]"}]}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "2", ",", " ", "3"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"i", ",", " ", 
         RowBox[{"i", " ", "+", " ", "n"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "M", "\[LeftDoubleBracket]", "\"\<R\>\"", "\[RightDoubleBracket]"}], 
       " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Join", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<R\>\"", ",", " ", "All", ",", " ", "i"}], 
            "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"C", "-", "S"}], ",", " ", "Q"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "M"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"189f400f-1636-429c-bb3c-ceb1cb7da3f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "H", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"Map", " ", "\[Rule]", " ", 
      RowBox[{"{", "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H", "[", 
     RowBox[{
      RowBox[{"cp_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"H", "[", 
     RowBox[{
      RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "cp", ",", " ",
       "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"mp_String", ",", " ", "cp_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "M", ",", " ", "S", ",", " ", "SL", ",", " ", "ST", ",", " ", "SF", ",",
        " ", "C"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Map", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"M", " ", "===", " ", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{
         RowBox[{"M", " ", "=", " ", 
          RowBox[{"BLP", "[", 
           RowBox[{"mp", ",", " ", "cp", ",", " ", "opts"}], "]"}]}], ";"}]}],
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"slack", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"S", " ", "=", " ", 
       RowBox[{
        RowBox[{"M", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", " ", "All", ",", " ", 
         RowBox[{
          RowBox[{"-", "5"}], ";;", 
          RowBox[{"-", "4"}]}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", "sdes"}], ",", " ", 
         RowBox[{
         "S", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "slope", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"SL", " ", "=", " ", 
       RowBox[{"slope", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SL", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{
           "SL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
           "-", " ", "\[Sigma]des"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
            "SL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ",
             "-", " ", "\[Sigma]des"}], "]"}], 
          RowBox[{
          "SL", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"step", " ", "size"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ST", " ", "=", " ", 
       RowBox[{"step", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ST", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ST", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
          "xdes"}], ",", " ", 
         RowBox[{
         "ST", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"swing", " ", "foot"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"SF", " ", "=", " ", 
       RowBox[{"knees", "[", 
        RowBox[{"M", ",", " ", "False"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"physical", " ", "parameter"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{
        RowBox[{"M", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", " ", "All", ",", " ", 
         RowBox[{
          RowBox[{"-", "2"}], ";;", 
          RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"C", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", "1"}], ",", " ", 
         RowBox[{
         "C", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Join", ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "S", ",", " ", "SL", ",", " ", "ST", ",", " ", "SF", ",", " ", "C"}],
          "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[21]:=",ExpressionUUID->"757a503b-a626-4825-ac48-4e6c6b04b98d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find (actuated) Gaits", "Subsection",
 InitializationCell->
  True,ExpressionUUID->"c7305bd6-288c-4461-9439-7e5d848bce6f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"c", " ", "=", " ", 
    RowBox[{
     RowBox[{"BLbiped", "[", 
      RowBox[{"\"\<\[DoubleStruckC]\>\"", ",", " ", 
       RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", 
       "\"\<eq\>\""}], "]"}], "[", "0.25", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]des", " ", "=", " ", 
   RowBox[{"0", " ", "Degree"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sdes", " ", "=", " ", 
   RowBox[{"20", "Degree"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xdes", " ", "=", " ", "0.5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"100", ",", " ", 
      RowBox[{"Length", "@", "c"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", " ", "=", " ", 
    RowBox[{"-", "L"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"-", "5"}], ";;", 
      RowBox[{"-", "3"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", "0"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "\[LeftDoubleBracket]", 
    RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U", "\[LeftDoubleBracket]", 
     RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], " ", "=", " ", "1"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "\[LeftDoubleBracket]", 
    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", "=", " ", "0.01"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U", "\[LeftDoubleBracket]", 
     RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", "=", " ", "1"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rootopts", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<cm\>\"", " ", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Print", " ", "\[Rule]", " ", "1"}], ",", " ", 
       RowBox[{"\"\<\[Beta]\>\"", " ", "\[Rule]", " ", "0.5"}], ",", " ", 
       RowBox[{"Root", " ", "\[Rule]", " ", "True"}], ",", " ", 
       RowBox[{"\"\<dtol\>\"", " ", "\[Rule]", " ", "100"}], ",", " ", 
       RowBox[{"\"\<min\>\"", " ", "\[Rule]", " ", "0"}], ",", " ", 
       RowBox[{"\"\<hmax\>\"", " ", "\[Rule]", " ", "0.2"}], ",", " ", 
       RowBox[{"\"\<cm\>\"", " ", "\[Rule]", " ", 
        RowBox[{"\"\<newton\>\"", " ", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Print", " ", "\[Rule]", " ", "1"}], ",", " ", 
           RowBox[{"\"\<max\>\"", " ", "\[Rule]", " ", "25"}], ",", " ", 
           RowBox[{"\"\<LU\>\"", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"L", ",", " ", "U"}], "}"}]}]}], "}"}]}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rootman", " ", "=", " ", 
   RowBox[{"BLGlobalHomotopy", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MarloT", ",", " ", "H"}], "}"}], ",", " ", "c", ",", " ", 
     RowBox[{"{", "Automatic", "}"}], ",", " ", "1000", ",", " ", 
     RowBox[{"Man", " ", "\[Rule]", " ", "rootopts"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rootman", " ", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{"rootman", ",", " ", 
     RowBox[{
      RowBox[{"#", " ", "=!=", " ", "$Failed"}], "&"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"532e1e72-f1ae-4785-a8ce-46876c92fe7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BLbiped", "[", 
    RowBox[{"\"\<draw\>\"", ",", " ", "\"\<axes\>\""}], "]"}], " ", "=", " ", 
   
   RowBox[{"{", 
    RowBox[{"2", ",", " ", "1", ",", " ", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"BLWalk", "[", 
  RowBox[{"rootman", ",", " ", 
   RowBox[{"-", "1"}], ",", " ", "2"}], "]"}]}], "Input",
 CellLabel->
  "In[38]:=",ExpressionUUID->"c119fb92-354a-4465-b3de-2d6ccdaab92e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check knees and foot height", \
"Section",ExpressionUUID->"75200353-fe7b-42b1-b24a-6956a877abd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", " ", "=", " ", 
   RowBox[{"rootman", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"-", "1"}], ",", " ", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", " ", "=", " ", 
   RowBox[{"MarloT", "[", 
    RowBox[{"\"\<right\>\"", ",", " ", "c"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", " ", "=", " ", 
   RowBox[{
    RowBox[{"M", "[", "\"\<T\>\"", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";"}]}], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"abae5a0d-fa28-4e74-ac31-b86acc8d2906"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"should", " ", "be", " ", "all", " ", "zeros"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "a"}], "}"}], " ", "=", " ", 
     RowBox[{"knees", "[", "M", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "[", "t", "]"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", "T"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", "T"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"M", "[", "\"\<x[t]\>\"", "]"}], "[", "t", "]"}], 
        "\[LeftDoubleBracket]", "14", "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"M", "[", "\"\<x[t]\>\"", "]"}], "[", "t", "]"}], 
        "\[LeftDoubleBracket]", "16", "\[RightDoubleBracket]"}]}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", "T"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"9121d146-b907-441d-af45-f4651ff1c841"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"BLFootHeight", "[", 
     RowBox[{"t", ",", " ", "M"}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", " ", "0", ",", " ", "T"}], "}"}], ",", " ", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", " ", 
      RowBox[{"InfiniteLine", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellLabel->
  "In[47]:=",ExpressionUUID->"cd142ec8-4196-4c98-886c-570a2734425f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Save Gaits", \
"Section",ExpressionUUID->"b112c8aa-07e6-463c-ba10-085814159a62"],

Cell["\<\
save computed gaits

variable name\t\t|  description
------------------------------------------------------------------------------\
---------------------------
rootman\t\t\t|  branches of gaits ending in a gait walking on flat ground

NOTE: The call to Save[...] will overwrite previous file.  Uncomment to use.  \
Recomment to avoid overwriting data.\
\>", "Text",ExpressionUUID->"1a4cbdfd-74ea-4b9a-862c-b173f0304146"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"uncomment", " ", "to", " ", "actually", " ", "save"}], ";", " ", 
    
    RowBox[{"should", " ", "recomment", " ", "when", " ", 
     RowBox[{"done", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BLSaveTo", "[", 
    RowBox[{
    "\"\<Here\>\"", ",", " ", "\"\<marlo-ghm.mx\>\"", ",", " ", "rootman"}], 
    "]"}], ";"}]}]], "Input",
 CellLabel->
  "In[48]:=",ExpressionUUID->"6191c77d-4975-49ad-9e70-e5cee2fb18c6"]
}, Open  ]]
}, Open  ]]
},
EvaluatorNames->{"Local" -> {"AutoStartOnLaunch" -> True}},
AutoGeneratedPackage->Automatic,
Evaluator->"Local",
WindowSize->{1373, 1383},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
CellContext->"Global`",
TrackCellChangeTimes->False,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]

